import{a as re,b as P,c as O,d as k,e as T,f as I,g as E,l as D,m as ae,n as se,o as de,p as N}from"./chunk-J6GQLRSX.js";import{B as y,Ba as ie,G as C,K as X,Ka as oe,L as u,M as g,O as z,P as R,Q as S,R as t,S as i,T as Z,U as w,V as p,W as c,aa as F,ba as a,c as Y,ca as m,da as $,ga as h,ha as _,ia as b,j as G,m as J,ma as ee,n as K,na as te,o as f,p as x,t as Q,xa as ne,y as l,ya as v}from"./chunk-7I7YWMIX.js";import{a as j}from"./chunk-C6Q5SG76.js";var W=class r{constructor(n){this.http=n}apiUrl="https://website-2eb58030.ich.rqh.mybluehost.me/api.php";loadActiveConsentForm(){let n=`${this.apiUrl}?action=get-consent-form`;return this.http.get(n).pipe(Y(e=>{if(!e.success||!e.data?.form){let o=e.message||e.error||"Failed to load consent form";throw new Error(o)}return e.data.form}))}static \u0275fac=function(e){return new(e||r)(J(ie))};static \u0275prov=G({token:r,factory:r.\u0275fac,providedIn:"root"})};var L=class r{initialData=null;continue=new C;form={firstName:"",lastName:"",phone:"",email:""};ngOnInit(){this.initialData&&(this.form=j({},this.initialData))}handleContinue(){this.continue.emit(j({},this.form))}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-consent-identity"]],inputs:{initialData:"initialData"},outputs:{continue:"continue"},decls:36,vars:4,consts:[[1,"step-card",3,"ngSubmit"],[1,"step-header"],[1,"field-grid"],[1,"field"],["type","text","name","firstName","required","","placeholder","e.g., Amy",3,"ngModelChange","ngModel"],["type","text","name","lastName","required","","placeholder","e.g., David",3,"ngModelChange","ngModel"],["type","tel","name","phone","required","","placeholder","(555) 123-4567",3,"ngModelChange","ngModel"],[1,"hint"],["type","email","name","email","placeholder","name@example.com",3,"ngModelChange","ngModel"],[1,"step-footer"],["type","submit",1,"btn-primary"]],template:function(e,o){e&1&&(t(0,"form",0),p("ngSubmit",function(){return o.handleContinue()}),t(1,"header",1)(2,"h2"),a(3,"Confirm Your Identity"),i(),t(4,"p"),a(5,"Please provide your contact details so we can match your consent to your Perfect Brow profile."),i()(),t(6,"div",2)(7,"label",3)(8,"span"),a(9,"First Name "),t(10,"sup"),a(11,"*"),i()(),t(12,"input",4),b("ngModelChange",function(d){return _(o.form.firstName,d)||(o.form.firstName=d),d}),i()(),t(13,"label",3)(14,"span"),a(15,"Last Name "),t(16,"sup"),a(17,"*"),i()(),t(18,"input",5),b("ngModelChange",function(d){return _(o.form.lastName,d)||(o.form.lastName=d),d}),i()()(),t(19,"label",3)(20,"span"),a(21,"Mobile Phone "),t(22,"sup"),a(23,"*"),i()(),t(24,"input",6),b("ngModelChange",function(d){return _(o.form.phone,d)||(o.form.phone=d),d}),i(),t(25,"small",7),a(26,"We use this to match your profile and send appointment updates."),i()(),t(27,"label",3)(28,"span"),a(29,"Email (optional)"),i(),t(30,"input",8),b("ngModelChange",function(d){return _(o.form.email,d)||(o.form.email=d),d}),i(),t(31,"small",7),a(32,"If provided, a verification code will be delivered here."),i()(),t(33,"footer",9)(34,"button",10),a(35,"Continue"),i()()()),e&2&&(l(12),h("ngModel",o.form.firstName),l(6),h("ngModel",o.form.lastName),l(6),h("ngModel",o.form.phone),l(6),h("ngModel",o.form.email))},dependencies:[v,N,E,P,O,k,D,I,T],styles:[".step-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px}.step-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px;color:#111827}.step-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0 0;color:#4b5563;font-size:15px;line-height:1.5}.field-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;font-size:14px;color:#374151}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:10px 14px;border-radius:8px;border:1px solid #d1d5db;font-size:15px}.field[_ngcontent-%COMP%]   sup[_ngcontent-%COMP%]{color:#d946ef}.hint[_ngcontent-%COMP%]{color:#6b7280;font-size:12px}.step-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;border:none;border-radius:8px;padding:10px 20px;font-size:15px;font-weight:600;cursor:pointer;transition:transform .2s ease,box-shadow .2s ease;box-shadow:0 10px 24px #d946ef40}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 12px 28px #d946ef52}"]})};var ge=(r,n)=>n.heading;function fe(r,n){if(r&1&&(t(0,"p",2),a(1),i()),r&2){let e=c();l(),m(e.leadText)}}function xe(r,n){if(r&1&&(t(0,"p"),a(1),i()),r&2){let e=c().$implicit;l(),m(e.body)}}function Ce(r,n){if(r&1){let e=w();t(0,"article",16)(1,"button",17),p("click",function(){let s=f(e).$index,d=c();return x(d.toggleSection(s))}),t(2,"span"),a(3),i(),t(4,"span",18),a(5),i()(),u(6,xe,2,1,"p"),i()}if(r&2){let e=n.$implicit,o=n.$index,s=c();F("expanded",s.isSectionExpanded(o)),l(3),m(e.heading),l(2),m(s.isSectionExpanded(o)?"\u2212":"+"),l(),g(s.isSectionExpanded(o)?6:-1)}}function he(r,n){r&1&&(t(0,"div",7),a(1,"Please acknowledge the consent terms before continuing."),i())}function _e(r,n){if(r&1){let e=w();t(0,"label",12)(1,"input",19),b("ngModelChange",function(s){f(e);let d=c();return _(d.confirmUpdates,s)||(d.confirmUpdates=s),x(s)}),i(),t(2,"span"),a(3,"If a stylist needs to update my existing profile contact details, I approve using this submission as confirmation."),i()()}if(r&2){let e=c();l(),h("ngModel",e.confirmUpdates)}}var B=class r{sections=[];isExpanded=!0;leadText=null;enableContactUpdatePrompt=!0;signatureHint=null;expectedSignature=null;expectedFirstName="";expectedLastName="";initialReviewData=null;back=new C;continue=new C;expandedSections=new Set;acknowledgedTerms=!1;signatureText="";confirmUpdates=!1;showAckError=!1;showSignatureError=!1;ngOnChanges(n){this.sections.length&&this.expandedSections.size===0&&this.sections.forEach((e,o)=>this.expandedSections.add(o)),n.initialReviewData&&this.initialReviewData&&(this.signatureText=this.initialReviewData.signatureText,this.acknowledgedTerms=this.initialReviewData.acknowledged,this.confirmUpdates=this.initialReviewData.confirmUpdates)}toggleSection(n){this.expandedSections.has(n)?this.expandedSections.delete(n):this.expandedSections.add(n)}isSectionExpanded(n){return this.expandedSections.has(n)}handleContinue(){this.continue.emit({signatureText:this.signatureText.trim(),confirmUpdates:this.enableContactUpdatePrompt?this.confirmUpdates:!0,acknowledged:this.acknowledgedTerms})}onAcknowledgedChange(){this.showAckError&&this.acknowledgedTerms&&(this.showAckError=!1)}onSignatureInput(n){this.signatureText=n}get isSignatureValid(){let n=`${this.expectedFirstName.trim()} ${this.expectedLastName.trim()}`;return this.signatureText.trim()===n}get isContinueEnabled(){let n=this.acknowledgedTerms&&this.isSignatureValid;return this.enableContactUpdatePrompt?n&&this.confirmUpdates:n}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-consent-review"]],inputs:{sections:"sections",isExpanded:"isExpanded",leadText:"leadText",enableContactUpdatePrompt:"enableContactUpdatePrompt",signatureHint:"signatureHint",expectedSignature:"expectedSignature",expectedFirstName:"expectedFirstName",expectedLastName:"expectedLastName",initialReviewData:"initialReviewData"},outputs:{back:"back",continue:"continue"},features:[Q],decls:28,vars:7,consts:[[1,"step-card",3,"ngSubmit"],[1,"step-header"],[1,"lead"],[1,"section-list"],[1,"section-item",3,"expanded"],[1,"confirm-checkbox"],["type","checkbox","name","acknowledgedTerms","required","",3,"ngModelChange","change","ngModel"],[1,"error-bubble"],[1,"signature-card"],[1,"signature-field"],["type","text","name","signatureText","required","","minlength","2",3,"ngModelChange","input","ngModel"],[1,"signature-note"],[1,"contact-update"],[1,"step-footer"],["type","button",1,"btn-outline",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"section-item"],["type","button",1,"section-toggle",3,"click"],[1,"icon"],["type","checkbox","name","confirmUpdates",3,"ngModelChange","ngModel"]],template:function(e,o){e&1&&(t(0,"form",0),p("ngSubmit",function(){return o.handleContinue()}),t(1,"header",1)(2,"h2"),a(3,"Review Consent Terms"),i(),t(4,"p"),a(5,"Applies to all Perfect Brow services, including eyelash extensions, waxing, threading, and skincare treatments."),i()(),u(6,fe,2,1,"p",2),t(7,"section",3),z(8,Ce,7,5,"article",4,ge),i(),t(10,"label",5)(11,"input",6),b("ngModelChange",function(d){return _(o.acknowledgedTerms,d)||(o.acknowledgedTerms=d),d}),p("change",function(){return o.onAcknowledgedChange()}),i(),t(12,"span"),a(13,"I acknowledge that I have read, understood, and agree to the terms above."),i()(),u(14,he,2,0,"div",7),t(15,"div",8)(16,"label",9)(17,"span"),a(18,"Type your full name as your electronic signature"),i(),t(19,"input",10),b("ngModelChange",function(d){return _(o.signatureText,d)||(o.signatureText=d),d}),p("input",function(d){return o.onSignatureInput(d.target.value)}),i()(),t(20,"p",11),a(21," Please type your first and last name exactly as entered on the identity step. By providing this signature, you confirm that you are the person named above and consent to the Perfect Brow service agreement. "),i()(),u(22,_e,4,1,"label",12),t(23,"footer",13)(24,"button",14),p("click",function(){return o.back.emit()}),a(25,"Back"),i(),t(26,"button",15),a(27,"Continue"),i()()()),e&2&&(l(6),g(o.leadText?6:-1),l(2),R(o.sections),l(3),h("ngModel",o.acknowledgedTerms),l(3),g(o.showAckError?14:-1),l(5),h("ngModel",o.signatureText),X("placeholder",o.signatureHint&&o.signatureHint.trim()?o.signatureHint.trim():"Type your full name"),l(3),g(o.enableContactUpdatePrompt?22:-1),l(4),S("disabled",!o.isContinueEnabled))},dependencies:[v,N,E,P,re,O,k,D,se,ae,I,T],styles:[".step-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.step-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px;color:#111827}.step-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0 0;color:#4b5563;font-size:15px}.lead[_ngcontent-%COMP%]{margin:0 0 16px;padding:14px 16px;border-radius:12px;background:#d946ef14;color:#4c1d95;font-size:14px;line-height:1.6;border:1px solid rgba(217,70,239,.18)}.section-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:14px}.section-item[_ngcontent-%COMP%]{border:1px solid #e5e7eb;border-radius:12px;background:#fff;overflow:hidden;transition:box-shadow .2s ease}.section-item.expanded[_ngcontent-%COMP%]{box-shadow:0 12px 24px #d946ef1f;border-color:#d946ef73}.section-toggle[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;align-items:center;padding:14px 18px;background:linear-gradient(180deg,#d946ef14,#ec489908);border:none;color:#6b21a8;font-weight:600;font-size:15px;cursor:pointer}.section-item[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{padding:0 18px 16px;margin:0;color:#374151;line-height:1.55;font-size:14px;white-space:pre-wrap}.icon[_ngcontent-%COMP%]{font-size:20px;font-weight:500}.confirm-checkbox[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px 14px;border-radius:10px;background:#d946ef14;color:#4c1d95;font-size:14px}.confirm-checkbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-top:3px}.signature-card[_ngcontent-%COMP%]{padding:20px;border-radius:14px;background:#fff;border:1px solid rgba(217,70,239,.25);box-shadow:inset 0 0 0 1px #ec489914;display:flex;flex-direction:column;gap:12px}.signature-field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;color:#4c1d95;font-size:14px}.signature-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:12px 14px;border-radius:10px;border:2px solid rgba(217,70,239,.3);font-size:16px;font-weight:600;color:#111827}.signature-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:gba(17,24,39,.2);font-weight:500}.signature-note[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:13px;line-height:1.6}.contact-update[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:12px;padding:12px 14px;border-radius:10px;background:#ec489914;color:#5b21b6;font-size:13px}.contact-update[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin-top:3px}.step-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px}.btn-outline[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:600;font-size:15px;cursor:pointer;transition:transform .2s ease}.btn-outline[_ngcontent-%COMP%]{background:#fff;border:1px solid #d1d5db;color:#374151}.btn-outline[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.btn-primary[_ngcontent-%COMP%]{border:none;background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;box-shadow:0 10px 24px #d946ef40}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 12px 28px #d946ef52}.btn-primary[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none;box-shadow:none}.error-bubble[_ngcontent-%COMP%]{padding:10px 14px;border-radius:8px;background:#ef44441a;color:#991b1b;border:1px solid rgba(239,68,68,.3);font-size:13px;line-height:1.5}"]})};function be(r,n){if(r&1&&(t(0,"strong"),a(1),i()),r&2){let e=c();l(),$("to ",e.deliveryChannel)}}function ye(r,n){r&1&&(t(0,"strong"),a(1,"to your contact info"),i())}var U=class r{deliveryChannel=null;countdownText="Ready to resend";back=new C;continue=new C;resend=new C;code="";handleSubmit(){this.continue.emit({code:this.code})}handleResend(){this.resend.emit()}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-consent-verify"]],inputs:{deliveryChannel:"deliveryChannel",countdownText:"countdownText"},outputs:{back:"back",continue:"continue",resend:"resend"},decls:23,vars:3,consts:[[1,"step-card",3,"ngSubmit"],[1,"step-header"],[1,"code-box"],[1,"field"],["type","text","maxlength","6","autocomplete","one-time-code","name","code","required","","placeholder","\u2022\u2022\u2022\u2022\u2022\u2022",3,"ngModelChange","ngModel"],[1,"countdown"],["type","button",1,"link-button",3,"click"],[1,"step-footer"],["type","button",1,"btn-outline",3,"click"],["type","submit",1,"btn-primary"]],template:function(e,o){e&1&&(t(0,"form",0),p("ngSubmit",function(){return o.handleSubmit()}),t(1,"header",1)(2,"h2"),a(3,"Enter Verification Code"),i(),t(4,"p"),a(5," We sent a 6-digit confirmation code "),u(6,be,2,1,"strong")(7,ye,2,0,"strong"),a(8,". "),i()(),t(9,"div",2)(10,"label",3)(11,"span"),a(12,"Verification Code"),i(),t(13,"input",4),b("ngModelChange",function(d){return _(o.code,d)||(o.code=d),d}),i()(),t(14,"p",5),a(15),i(),t(16,"button",6),p("click",function(){return o.handleResend()}),a(17,"Resend code"),i()(),t(18,"footer",7)(19,"button",8),p("click",function(){return o.back.emit()}),a(20,"Back"),i(),t(21,"button",9),a(22,"Verify & Continue"),i()()()),e&2&&(l(6),g(o.deliveryChannel?6:7),l(7),h("ngModel",o.code),l(2),m(o.countdownText))},dependencies:[v,N,E,P,O,k,D,de,I,T],styles:[".step-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:20px}.step-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:22px;color:#111827}.step-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:6px 0 0;color:#4b5563;font-size:15px}.code-box[_ngcontent-%COMP%]{border-radius:14px;padding:22px;background:linear-gradient(180deg,#d946ef1f,#ec48990a);border:1px solid rgba(217,70,239,.25);display:flex;flex-direction:column;gap:14px}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px;font-size:14px;color:#4c1d95}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:12px 16px;font-size:24px;text-align:center;letter-spacing:.5em;border-radius:10px;border:2px solid rgba(217,70,239,.35);background:#fff;font-weight:600;color:#111827}.countdown[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:13px}.link-button[_ngcontent-%COMP%]{width:fit-content;background:none;border:none;color:#d946ef;font-weight:600;cursor:pointer;padding:0;font-size:14px}.step-footer[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px}.btn-outline[_ngcontent-%COMP%], .btn-primary[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:600;font-size:15px;cursor:pointer;transition:transform .2s ease}.btn-outline[_ngcontent-%COMP%]{background:#fff;border:1px solid #d1d5db;color:#374151}.btn-outline[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}.btn-primary[_ngcontent-%COMP%]{border:none;background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;box-shadow:0 10px 24px #d946ef40}.btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 12px 28px #d946ef52}"]})};function ve(r,n){if(r&1&&(t(0,"div")(1,"dt"),a(2,"Signature"),i(),t(3,"dd"),a(4),i()()),r&2){let e=c(2);l(4),m(e.receipt.signatureName)}}function we(r,n){if(r&1&&(t(0,"dl",2)(1,"div")(2,"dt"),a(3,"Name"),i(),t(4,"dd"),a(5),i()(),t(6,"div")(7,"dt"),a(8,"Signed"),i(),t(9,"dd"),a(10),ee(11,"date"),i()(),t(12,"div")(13,"dt"),a(14,"Verification"),i(),t(15,"dd"),a(16),i()(),t(17,"div")(18,"dt"),a(19,"Consent Version"),i(),t(20,"dd"),a(21),i()(),u(22,ve,5,1,"div"),i()),r&2){let e=c();l(5),m(e.receipt.customerName||"\u2014"),l(5),m(te(11,5,e.receipt.stepsCompletedAt,"fullDate")),l(6),m(e.receipt.verificationChannel||"Confirmed in studio"),l(5),m(e.receipt.consentVersion),l(),g(e.receipt.signatureName?22:-1)}}var q=class r{receipt=null;startOver=new C;static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-consent-success"]],inputs:{receipt:"receipt"},outputs:{startOver:"startOver"},decls:13,vars:1,consts:[[1,"step-card","success-card"],["aria-hidden","true",1,"hero-icon"],[1,"receipt"],[1,"step-footer"],["type","button",1,"btn-primary",3,"click"],["routerLink","/",1,"btn-outline"]],template:function(e,o){e&1&&(t(0,"section",0)(1,"div",1),a(2,"\u2713"),i(),t(3,"h2"),a(4,"Consent Submitted!"),i(),t(5,"p"),a(6," Thank you for completing your Perfect Brow services consent. A receipt has been sent to your contact email. "),i(),u(7,we,23,8,"dl",2),t(8,"footer",3)(9,"button",4),p("click",function(){return o.startOver.emit()}),a(10,"Start a new consent"),i(),t(11,"a",5),a(12,"Return to Register"),i()()()),e&2&&(l(7),g(o.receipt?7:-1))},dependencies:[v,oe,ne],styles:[".step-card[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:18px;text-align:center;align-items:center}.hero-icon[_ngcontent-%COMP%]{width:72px;height:72px;border-radius:50%;background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;display:flex;align-items:center;justify-content:center;font-size:36px;font-weight:700;box-shadow:0 12px 24px #d946ef47}.success-card[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;color:#111827}.success-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#4b5563;font-size:15px}.receipt[_ngcontent-%COMP%]{margin:8px 0 0;display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;width:100%;text-align:left}.receipt[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{padding:12px 16px;border-radius:12px;background:#fff;border:1px solid rgba(209,213,219,.8)}.receipt[_ngcontent-%COMP%]   dt[_ngcontent-%COMP%]{margin:0 0 4px;font-size:12px;text-transform:uppercase;letter-spacing:.07em;color:#6b7280}.receipt[_ngcontent-%COMP%]   dd[_ngcontent-%COMP%]{margin:0;font-size:15px;color:#111827;font-weight:600}.step-footer[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:center;gap:14px;margin-top:12px}.btn-primary[_ngcontent-%COMP%], .btn-outline[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:600;font-size:15px;cursor:pointer;text-decoration:none;transition:transform .2s ease}.btn-primary[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;border:none;box-shadow:0 10px 24px #d946ef40}.btn-outline[_ngcontent-%COMP%]{border:1px solid #d1d5db;background:#fff;color:#374151}.btn-primary[_ngcontent-%COMP%]:hover, .btn-outline[_ngcontent-%COMP%]:hover{transform:translateY(-1px)}"]})};var Se=(r,n)=>n.id;function Me(r,n){if(r&1&&(t(0,"li",11)(1,"span",12),a(2),i(),t(3,"div")(4,"div",13),a(5),i(),t(6,"div",14),a(7),i()()()),r&2){let e=n.$implicit,o=n.$index,s=c();F("active",o===s.currentStepIndex)("complete",o<s.currentStepIndex),l(2),m(o+1),l(3),m(e.title),l(2),m(e.subtitle)}}function Pe(r,n){if(r&1){let e=w();t(0,"app-consent-identity",15),p("continue",function(s){f(e);let d=c();return x(d.handleIdentityContinue(s))}),i()}if(r&2){let e=c();S("initialData",e.identityData)}}function Oe(r,n){r&1&&(t(0,"div",16),Z(1,"div",17),t(2,"p"),a(3,"Loading the latest consent terms..."),i()())}function ke(r,n){if(r&1){let e=w();t(0,"div",18)(1,"p"),a(2),i(),t(3,"button",20),p("click",function(){f(e);let s=c(3);return x(s.fetchConsentForm())}),a(4,"Retry loading"),i()()}if(r&2){let e=c(3);l(2),m(e.loadFormError)}}function Te(r,n){r&1&&(t(0,"div",18)(1,"p"),a(2,"Consent terms are currently unavailable. Please try again later."),i()())}function Ie(r,n){if(r&1){let e=w();t(0,"app-consent-review",21),p("back",function(){f(e);let s=c(3);return x(s.goToPreviousStep())})("continue",function(s){f(e);let d=c(3);return x(d.handleReviewContinue(s))}),i()}if(r&2){let e=c(3);S("sections",e.consentSections)("leadText",e.reviewLeadText)("enableContactUpdatePrompt",!0)("signatureHint",e.identityData?e.identityData.firstName+" "+e.identityData.lastName:null)("expectedFirstName",(e.identityData==null?null:e.identityData.firstName)||"")("expectedLastName",(e.identityData==null?null:e.identityData.lastName)||"")("initialReviewData",e.reviewSubmission)}}function Ee(r,n){if(r&1&&(u(0,ke,5,1,"div",18),u(1,Te,3,0,"div",18)(2,Ie,1,7,"app-consent-review",19)),r&2){let e=c(2);g(e.loadFormError?0:-1),l(),g(e.consentSections.length?2:1)}}function De(r,n){if(r&1&&u(0,Oe,4,0,"div",16)(1,Ee,3,2),r&2){let e=c();g(e.isLoadingForm?0:1)}}function Ne(r,n){if(r&1){let e=w();t(0,"app-consent-verify",22),p("back",function(){f(e);let s=c();return x(s.goToPreviousStep())})("continue",function(s){f(e);let d=c();return x(d.handleVerificationContinue(s))})("resend",function(){f(e);let s=c();return x(s.handleResendRequested())}),i()}if(r&2){let e=c();S("deliveryChannel",(e.identityData==null?null:e.identityData.email)||(e.identityData==null?null:e.identityData.phone)||null)}}function Ve(r,n){if(r&1){let e=w();t(0,"app-consent-success",23),p("startOver",function(){f(e);let s=c();return x(s.restart())}),i()}if(r&2){let e=c();S("receipt",e.receiptPreview)}}var ce=class r{consentService=K(W);inactivityTimer=null;INACTIVITY_TIMEOUT=300*1e3;fallbackForm={consent_form_id:0,title:"Perfect Brow Services Consent",version:"2024-01",body:`I acknowledge that I have read, understood, and agree to the following terms and conditions:

No Refund Policy
I understand and agree that all services provided by the salon are non-refundable. While the salon strives to deliver the highest quality of service, no refunds will be issued under any circumstances. If I am dissatisfied with a service, the salon may, at its sole discretion, attempt to rectify the issue.

General Acknowledgment of Risk
I understand that the services offered by the salon, including but not limited to haircuts, makeup, microblading, eyebrow shaping, waxing, threading, facials, and hairstyling, involve certain risks. I voluntarily assume all such risks and agree that the salon and its technicians shall not be liable for any adverse reactions, injuries, or dissatisfaction resulting from any service provided.

Eyelash Extension Services
If availing of eyelash extension services, I specifically agree to the following terms:
a. I acknowledge and understand that there are inherent risks associated with the application and removal of artificial eyelashes. These risks may include, but are not limited to, irritation, discomfort, allergic reactions, swelling, itching, pain, and, in rare cases, infection.
b. I understand that eyelash extensions will be applied to my natural eyelashes as determined by the technician to maintain the health, growth, and natural appearance of my eyelashes. Excessive weight on natural lashes will be avoided to prevent damage.
c. I acknowledge that despite proper application and removal procedures, adhesive materials used in the process may become dislodged during or after the procedure, potentially causing irritation or requiring additional follow-up care.
d. I agree to follow all aftercare instructions provided by the technician. I understand that failure to adhere to these instructions may result in the premature shedding of the extensions, potential irritation, or damage to my natural eyelashes.
e. I understand that the eyelash extension procedure requires me to keep my eyes closed for a period of approximately 60 to 100 minutes while lying in a reclined position. I acknowledge that if I have any medical conditions that could be aggravated by remaining still for an extended period, I may be unable to undergo the procedure.
f. If I experience any adverse reactions, irritation, or complications following the procedure, I agree to immediately contact my technician for removal and, if necessary, consult a physician at my own expense.

Duration of Agreement
This agreement shall remain in effect for all procedures performed by my technician for one (1) year from the date of signing.

Age Requirement
I affirm that I am at least 18 years of age. If I am under the age of 18 but at least 13 years old, I understand that a parent or legal guardian must also sign this form. Services will not be provided to individuals under the age of 13.

Release of Liability
I hereby release and hold harmless the salon, its owners, employees, and contractors from any and all liability, claims, damages, or expenses arising out of or in connection with any services rendered. I assume full responsibility for any risks, known or unknown, associated with the services I receive.

Consent to Treatment
By signing below, I acknowledge that I have read and fully understand this agreement. I voluntarily agree to undergo the requested services and accept all terms and conditions outlined herein.`,is_active:1};steps=[{id:"identity",title:"Identity",subtitle:"Tell us who you are"},{id:"review",title:"Review Terms",subtitle:"Read required consent language"},{id:"verify",title:"Email Code",subtitle:"Confirm your contact details"},{id:"success",title:"Finished",subtitle:"You are all set"}];currentStepIndex=0;identityData=null;verificationData=null;reviewSubmission=null;consentForm=null;reviewLeadText=null;consentSections=[];isLoadingForm=!1;loadFormError=null;receiptPreview={customerName:"",stepsCompletedAt:new Date().toISOString(),consentVersion:"\u2014",verificationChannel:null};ngOnInit(){this.fetchConsentForm(),this.resetInactivityTimer()}ngOnDestroy(){this.clearInactivityTimer()}resetInactivityTimer(){this.clearInactivityTimer(),this.inactivityTimer=setTimeout(()=>{this.currentStepIndex<this.steps.length-1&&this.restart()},this.INACTIVITY_TIMEOUT)}clearInactivityTimer(){this.inactivityTimer&&(clearTimeout(this.inactivityTimer),this.inactivityTimer=null)}get currentStep(){return this.steps[this.currentStepIndex]?.id??"identity"}handleIdentityContinue(n){this.identityData=n,this.receiptPreview.customerName=`${n.firstName} ${n.lastName}`.trim(),this.receiptPreview.verificationChannel=n.email||n.phone,this.resetInactivityTimer(),this.goToNextStep()}handleReviewContinue(n){this.reviewSubmission=n,this.receiptPreview.signatureName=n.signatureText,this.resetInactivityTimer(),this.goToNextStep()}handleVerificationContinue(n){this.verificationData=n,this.receiptPreview.stepsCompletedAt=new Date().toISOString(),this.resetInactivityTimer(),this.goToNextStep()}handleResendRequested(){this.resetInactivityTimer()}restart(){this.currentStepIndex=0,this.identityData=null,this.verificationData=null,this.reviewSubmission=null,this.receiptPreview={customerName:"",stepsCompletedAt:new Date().toISOString(),consentVersion:this.consentForm?.version??"\u2014",verificationChannel:null,signatureName:void 0}}goToNextStep(){this.currentStepIndex<this.steps.length-1&&(this.currentStepIndex+=1)}goToPreviousStep(){this.currentStepIndex>0&&(this.currentStepIndex-=1,this.resetInactivityTimer())}fetchConsentForm(){this.isLoadingForm=!0,this.loadFormError=null,this.consentService.loadActiveConsentForm().subscribe({next:n=>{this.applyConsentForm(n)},error:n=>{console.error("Failed to load consent form",n),this.loadFormError=(n instanceof Error?n.message:null)||"Consent form could not be loaded from the server. Showing latest available copy.",this.applyConsentForm(this.fallbackForm)}})}applyConsentForm(n){this.consentForm=n;let{lead:e,sections:o}=this.parseConsentBody(n.body??"");this.reviewLeadText=e||null,this.consentSections=o,this.receiptPreview.consentVersion=n.version||"\u2014",this.isLoadingForm=!1}parseConsentBody(n){let e=n.replace(/\r\n/g,`
`).trim();if(!e)return{lead:"",sections:[]};let o=e.split(/\n{2,}/).map(M=>M.trim()).filter(Boolean);if(!o.length)return{lead:"",sections:[]};let[s,...d]=o;if(!d.length)return{lead:"",sections:[{heading:"Consent Terms",body:s}]};let pe=d.map(M=>{let H=M.split(`
`),me=H.shift()?.trim()??"",ue=H.join(`
`).trim();return{heading:me,body:ue}}).filter(M=>M.heading||M.body);return{lead:s,sections:pe}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=y({type:r,selectors:[["app-consent-wizard"]],decls:18,vars:1,consts:[[1,"consent-wrap"],[1,"consent-card"],[1,"consent-header"],[1,"brand-lockup"],[1,"brand-tag"],["aria-label","Consent steps",1,"stepper"],[1,"step",3,"active","complete"],["aria-live","polite",1,"consent-content"],[3,"initialData"],[3,"deliveryChannel"],[3,"receipt"],[1,"step"],[1,"step-index"],[1,"step-title"],[1,"step-subtitle"],[3,"continue","initialData"],[1,"wizard-feedback"],["aria-hidden","true",1,"spinner"],[1,"wizard-feedback","error"],[3,"sections","leadText","enableContactUpdatePrompt","signatureHint","expectedFirstName","expectedLastName","initialReviewData"],["type","button",1,"btn-primary",3,"click"],[3,"back","continue","sections","leadText","enableContactUpdatePrompt","signatureHint","expectedFirstName","expectedLastName","initialReviewData"],[3,"back","continue","resend","deliveryChannel"],[3,"startOver","receipt"]],template:function(e,o){if(e&1&&(t(0,"div",0)(1,"div",1)(2,"header",2)(3,"div",3)(4,"div",4),a(5,"Perfect Brow"),i(),t(6,"h1"),a(7,"Services Consent Wizard"),i(),t(8,"p"),a(9,"Complete all steps to digitally sign your Perfect Brow service agreement."),i()(),t(10,"ul",5),z(11,Me,8,7,"li",6,Se),i()(),t(13,"main",7),u(14,Pe,1,1,"app-consent-identity",8)(15,De,2,1)(16,Ne,1,1,"app-consent-verify",9)(17,Ve,1,1,"app-consent-success",10),i()()()),e&2){let s;l(11),R(o.steps),l(3),g((s=o.currentStep)==="identity"?14:s==="review"?15:s==="verify"?16:s==="success"?17:-1)}},dependencies:[v,L,B,U,q],styles:[".consent-wrap[_ngcontent-%COMP%]{min-height:100vh;display:flex;justify-content:center;padding:32px 16px 64px;background:linear-gradient(135deg,#d946ef14,#ec489926)}.consent-card[_ngcontent-%COMP%]{max-width:960px;width:100%;background:#fff;border-radius:18px;box-shadow:0 20px 45px #1118271f;border:1px solid rgba(229,231,235,.9);overflow:hidden;display:flex;flex-direction:column}.consent-header[_ngcontent-%COMP%]{padding:28px 32px 20px;border-bottom:1px solid rgba(229,231,235,.9);background:linear-gradient(180deg,#d946ef1f,#ec489905)}.brand-lockup[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:8px 0 6px;font-size:26px;font-weight:700;color:#111827}.brand-lockup[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#4b5563;font-size:15px}.brand-tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:6px;padding:6px 12px;border-radius:999px;background:#ec48991f;color:#9d174d;font-weight:600;font-size:12px;letter-spacing:.08em;text-transform:uppercase}.stepper[_ngcontent-%COMP%]{margin:24px 0 0;padding:0;list-style:none;display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:14px}.step[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;padding:12px;border-radius:12px;border:1px solid rgba(209,213,219,.9);background:#fff;transition:border .2s ease,box-shadow .2s ease,transform .2s ease}.step[_ngcontent-%COMP%]   .step-index[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;display:grid;place-items:center;font-weight:600;background:#d1d5db66;color:#4b5563}.step[_ngcontent-%COMP%]   .step-title[_ngcontent-%COMP%]{font-weight:600;color:#1f2937;font-size:14px}.step[_ngcontent-%COMP%]   .step-subtitle[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.step.active[_ngcontent-%COMP%]{border-color:#d946ef99;box-shadow:0 12px 24px #d946ef1f;transform:translateY(-1px)}.step.active[_ngcontent-%COMP%]   .step-index[_ngcontent-%COMP%]{background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff}.step.complete[_ngcontent-%COMP%]{border-color:#22c55e66}.step.complete[_ngcontent-%COMP%]   .step-index[_ngcontent-%COMP%]{background:#22c55e2e;color:#15803d}.consent-content[_ngcontent-%COMP%]{padding:32px;display:flex;flex-direction:column}.wizard-feedback[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:12px;padding:28px;border-radius:16px;border:1px dashed rgba(217,70,239,.35);background:#d946ef0d;color:#4c1d95;text-align:center;font-size:15px}.wizard-feedback.error[_ngcontent-%COMP%]{border-color:#ef444459;background:#fee2e299;color:#b91c1c}.wizard-feedback[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;border:4px solid rgba(217,70,239,.25);border-top-color:#d946ef;animation:_ngcontent-%COMP%_spin .9s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.wizard-feedback[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{margin-top:8px;background:linear-gradient(135deg,#d946ef,#ec4899);color:#fff;border:none;border-radius:999px;padding:10px 20px;font-weight:600;cursor:pointer;box-shadow:0 12px 24px #d946ef40;transition:transform .2s ease,box-shadow .2s ease}.wizard-feedback[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]:hover{transform:translateY(-1px);box-shadow:0 16px 28px #d946ef52}@media (max-width: 720px){.consent-card[_ngcontent-%COMP%]{border-radius:16px}.consent-header[_ngcontent-%COMP%]{padding:22px 24px 18px}.consent-content[_ngcontent-%COMP%]{padding:24px}.step[_ngcontent-%COMP%]{flex-direction:row;align-items:flex-start}}"]})};export{ce as ConsentWizardComponent};
